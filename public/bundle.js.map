{"version":3,"file":"bundle.js","sources":["../src/webcam.js","../src/trunkDetector.js","../src/canvas.js","../src/jacket.js","../src/app.js","../src/ui.js","../src/main.js"],"sourcesContent":["class Webcam {\n    constructor({ video, width = 640, height = 480, autostart = true}) {\n        this.video = video;\n        this.video.width = width;\n        this.video.height = height;\n        this.autostart = autostart;\n    }\n\n    async init() {\n        const stream = await navigator.mediaDevices.getUserMedia({\n            'audio': false,\n            'video': {\n                facingMode: 'environment',\n                width: this.video.width,\n                height: this.video.height,\n            },\n        });\n        this.video.srcObject = stream;\n    \n        return new Promise((resolve) => {\n            this.video.onloadedmetadata = () => {\n                if (this.autostart) this.video.play();\n                resolve();\n            }\n        });\n    }\n}\n\nexport default Webcam;","class TrunkDetector {\n    constructor({ \n        video, \n        callback = null, \n        options = {\n            architecture: 'MobileNetV1',\n            imageScaleFactor: 0.3,\n            outputStride: 16,\n            inputResolution: 193,\n            flipHorizontal: false,\n            minConfidence: 0.5,\n            maxPoseDetections: 5,\n            scoreThreshold: 0.5,\n            nmsRadius: 20,\n            detectionType: 'single',\n            multiplier: 0.75,\n            quantBytes: 2,\n          }\n    }) {\n        this.video = video;\n        this.callback = callback;\n        this.options = options;\n\n        this.net = ml5.poseNet(\n            this.video, \n            this.options, \n            () => this.ready()\n        );\n    }\n\n    onDetect(callback) { this.callback = callback; }\n\n    ready() {\n        this.net.on(\"pose\", res => this.detected(res[0]));\n    }\n\n    calcAnchor(pose) {\n        let x = [\n            pose.leftShoulder.x, \n            pose.rightShoulder.x,\n            pose.leftHip.x,\n            pose.rightHip.x\n        ];\n\n        let y = [\n            pose.leftShoulder.y, \n            pose.rightShoulder.y,\n            pose.leftHip.y,\n            pose.rightHip.y\n        ];\n\n        return {\n            x: pose.nose.x,\n            y: (pose.nose.y + Math.min(...y)) / 2\n        }\n    }\n\n    detected(estimation) {\n        if (estimation && this.callback) {\n            let anchor = this.calcAnchor(estimation.pose);\n            this.callback(anchor);\n        }\n    }\n}\n\nexport default TrunkDetector;","class Canvas {\n    constructor(id, video, width, height) {\n        this.elem = document.getElementById(id);\n        this.video = video;\n        \n        this.elem.width = width;\n        this.elem.height = height;\n        this.context = this.elem.getContext('2d');\n\n        this.anchor = null;\n        this.__loop();\n    }\n\n    __loop() {\n        this.context.drawImage(\n            this.video, \n            0, \n            0, \n            this.elem.width, \n            this.elem.height\n        );\n        \n        if (this.anchor) this.__drawImage(this.anchor);\n        \n        window.requestAnimationFrame(() => this.__loop() );\n    }\n\n    __drawArea({ x, y, w, h }) {\n        this.context.beginPath();\n        this.context.lineWidth = 10;\n        this.context.strokeStyle = '#00ff04';\n        this.context.rect(x, y, w, h);\n        this.context.stroke();\n    }\n\n    __drawPoint({ x, y, color = '#00ff04' }) {\n        this.context.beginPath();\n        this.context.arc(x, y, 10, 0, 2 * Math.PI);\n        this.context.fillStyle = color;\n        this.context.fill();\n    }\n\n    __drawImage({ img, x, y }) {\n        this.context.drawImage(img, x, y);\n    }\n}\n\nexport default Canvas;","const Models = {\n    BLACK: {\n        img: './assets/black.png',\n        name: 'A0129 GORE-TEX PACLITE® PRODUCT TECHNOLOGY WITH PRIMALOFT® INSULATION',\n        prize: 799.00,\n        url: 'https://www.stoneisland.com/es/stone-island/blazer_cod41890405tb.html'\n    },\n    RED: {\n        img: './assets/red.png',\n        name: '43031 DAVID LIGHT-TC WITH MICROPILE',\n        prize: 660.00,\n        url: 'https://www.stoneisland.com/es/stone-island/cazadora_cod41890734ur.html'\n    },\n    BROWN: {\n        img: './assets/brown.png',\n        name: '70631 DAVID LIGHT-TC WITH MICROPILE',\n        prize: 799.00,\n        url: 'https://www.stoneisland.com/es/stone-island/chaqueton_cod41890540lb.html'\n    }\n}\n\nconst Sizes = {\n    S: 'S',\n    M: 'M',\n    L: 'L',\n    XL: 'XL'\n}\n\nclass Jacket {\n    constructor(model, size, onLoad) {\n        this.__current = model;\n        this.__size = size;\n        this.__base = {\n            width: 398,\n            height: 641\n        }\n\n        this.__callback = onLoad;\n        this.__init();\n    }\n\n    __init() {\n        this.__image = new Image();\n        \n        this.__image.onload = () => this.__callback(this);\n        this.__image.src = this.__current.img;\n        this.__image.width = this.size.width;\n        this.__image.height = this.size.height;\n    }\n\n    img() {\n        return this.__image\n    }\n\n    size() {\n        switch(this.__size) {\n            case Sizes.S:\n                return {\n                    width: this.__base.width - 10,\n                    height: this.__base.height - 10\n                }\n            case Sizes.L:\n                return {\n                    width: this.__base.width + 10,\n                    height: this.__base.height + 10\n                }\n            case Sizes.XL:\n                return {\n                    width: this.__base.width + 20,\n                    height: this.__base.height + 20\n                }\n            default:\n                return this.__base\n        }\n    }\n\n    offset() {\n        let size = this.size();\n        return {\n            x: -size.width / 2,\n            y: 0\n        }\n    }\n}\n\nexport default Jacket;\nexport {\n    Jacket,\n    Models,\n    Sizes\n}","import Webcam from './webcam.js'\nimport TrunkDetector from './trunkDetector.js'\nimport Canvas from './canvas'\nimport { Jacket, Sizes, Models } from './jacket.js'\n\nclass ARApp {\n    constructor(video, width, height) {\n        this.video = video;\n\n        this.webcam = new Webcam({ \n            video: this.video, \n            width: width,\n            height: height\n        });\n        this.webcam.init();\n        \n        this.detector = new TrunkDetector({ video: this.video });  \n        \n        this.canvas = new Canvas(\n            'camera', \n            this.video, \n            width, \n            height\n        );\n\n        this.__current = {\n            model: null,\n            size: Sizes.M\n        };\n    }\n\n    start() {\n        this.detector.onDetect((anchor) => {\n            if (this.__current.model) {\n                new Jacket(\n                    this.__current.model, \n                    this.__current.size, \n                    jacket => {\n                        let offset = jacket.offset();\n        \n                        this.canvas.anchor = {\n                            img: jacket.img(),\n                            x: anchor.x + offset.x,\n                            y: anchor.y + offset.y - 20\n                        }\n                    }\n                );\n            }\n        });\n    }\n\n    jacket(model) {\n        switch(model) {\n            case \"black\":\n                this.__current.model = Models.BLACK\n                break\n            case \"red\":\n                this.__current.model = Models.RED\n                break\n            case \"brown\":\n                this.__current.model = Models.BROWN\n                break\n        }\n    }\n\n    size(size) {\n        if (Object.values(Sizes).includes(size)) this.__current.size = size;\n    }\n}\n\nexport default ARApp;","class UI {\n    constructor() {\n        this.__callback = null;\n        this.__videoElem = document.getElementById(\"video\");\n        this.__jacketElemList = document.querySelectorAll('.jacket');\n\n        this.__listeners();\n    }\n\n    get video() {\n        return this.__videoElem;\n    }\n\n    onSelectJacket(callback) {\n        this.__callback = callback;\n    }\n\n    __listeners() {\n        this.__jacketElemList.forEach(jacket => {\n            jacket.addEventListener(\"click\", () => {\n                this.__jacketElemList.forEach(it => it.classList.remove('selected'));\n    \n                jacket.classList.add('selected');\n                if (this.__callback) this.__callback(jacket.getAttribute(\"data-jacket\"));\n            });\n        });\n    }\n}\n\nexport default UI;","import ARApp from './app'\nimport UI from './ui';\n\nlet ui = new UI();\nlet app = new ARApp(ui.video, 1024, 768);\n\nui.onSelectJacket(model => {\n    app.jacket(model);\n});\n\napp.start();\n\n"],"names":["Webcam","video","width","height","autostart","navigator","mediaDevices","getUserMedia","facingMode","stream","srcObject","Promise","resolve","onloadedmetadata","play","TrunkDetector","callback","options","architecture","imageScaleFactor","outputStride","inputResolution","flipHorizontal","minConfidence","maxPoseDetections","scoreThreshold","nmsRadius","detectionType","multiplier","quantBytes","net","ml5","poseNet","ready","on","res","detected","pose","x","leftShoulder","rightShoulder","leftHip","rightHip","y","nose","Math","min","estimation","anchor","calcAnchor","Canvas","id","elem","document","getElementById","context","getContext","__loop","drawImage","__drawImage","window","requestAnimationFrame","w","h","beginPath","lineWidth","strokeStyle","rect","stroke","color","arc","PI","fillStyle","fill","img","Models","BLACK","name","prize","url","RED","BROWN","Sizes","S","M","L","XL","Jacket","model","size","onLoad","__current","__size","__base","__callback","__init","__image","Image","onload","src","ARApp","webcam","init","detector","canvas","onDetect","jacket","offset","Object","values","includes","UI","__videoElem","__jacketElemList","querySelectorAll","__listeners","forEach","addEventListener","it","classList","remove","add","getAttribute","ui","app","onSelectJacket","start"],"mappings":"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"}